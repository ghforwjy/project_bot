# ä¿®å¤ç”˜ç‰¹å›¾ä»»åŠ¡ç‚¹å‡»å’Œé¼ æ ‡æ‚¬åœå†²çªé—®é¢˜

## é—®é¢˜åˆ†æ

é€šè¿‡æ£€æŸ¥GanttChart.tsxä¸­çš„ä»»åŠ¡æ¸²æŸ“ä»£ç ï¼Œå‘ç°äº†ä»¥ä¸‹é—®é¢˜ï¼š

### 1. äº‹ä»¶å¤„ç†å™¨å†²çª
- **ä»»åŠ¡æ ‡é¢˜ï¼ˆtaskTitleï¼‰**ï¼šæœ‰mouseoverå’Œmouseoutäº‹ä»¶ï¼Œæ˜¾ç¤ºå·¥å…·æç¤º
- **ä»»åŠ¡æ¡ï¼ˆtaskBarï¼‰**ï¼šæœ‰mouseoverã€mouseoutå’Œclickäº‹ä»¶ï¼Œæ˜¾ç¤ºå·¥å…·æç¤ºå’Œè§¦å‘onTaskClick

### 2. å†²çªåŸå› 
å½“ç”¨æˆ·ç‚¹å‡»ä»»åŠ¡æ¡æ—¶ï¼š
1. è§¦å‘taskBarçš„clickäº‹ä»¶ï¼Œè°ƒç”¨onTaskClick
2. åŒæ—¶ä¹Ÿä¼šè§¦å‘taskTitleçš„mouseoveräº‹ä»¶ï¼Œæ˜¾ç¤ºå·¥å…·æç¤º
3. è¿™å¯¼è‡´å·¥å…·æç¤ºå’Œç‚¹å‡»äº‹ä»¶å†²çªï¼Œå½±å“ç”¨æˆ·ä½“éªŒ

### 3. äº‹ä»¶ä¼ æ’­é—®é¢˜
- taskTitleçš„mouseoveräº‹ä»¶ä¼šé˜»æ­¢äº‹ä»¶å†’æ³¡
- taskBarçš„clickäº‹ä»¶å¯èƒ½è¢«mouseoveräº‹ä»¶å¹²æ‰°

## è§£å†³æ–¹æ¡ˆ

### 1. ä¼˜åŒ–äº‹ä»¶å¤„ç†é€»è¾‘

#### 1.1 ç§»é™¤ä»»åŠ¡æ ‡é¢˜çš„é¼ æ ‡äº‹ä»¶
- ç§»é™¤taskTitleçš„mouseoverå’Œmouseoutäº‹ä»¶
- åªä¿ç•™ä»»åŠ¡æ¡çš„é¼ æ ‡äº‹ä»¶å¤„ç†

#### 1.2 ç»Ÿä¸€äº‹ä»¶å¤„ç†
- åœ¨taskBarä¸Šç»Ÿä¸€å¤„ç†æ‰€æœ‰é¼ æ ‡äº‹ä»¶
- ç¡®ä¿ç‚¹å‡»äº‹ä»¶ä¼˜å…ˆäºæ‚¬åœäº‹ä»¶

### 2. å®ç°ç»†èŠ‚

#### 2.1 ä¿®æ”¹renderTaskå‡½æ•°
- ç§»é™¤taskTitleçš„mouseoverå’Œmouseoutäº‹ä»¶å¤„ç†å™¨
- ç®€åŒ–taskTitleçš„å®ç°ï¼Œåªæ˜¾ç¤ºæ–‡æœ¬

#### 2.2 ä¼˜åŒ–taskBarçš„äº‹ä»¶å¤„ç†
- ç¡®ä¿mouseoveräº‹ä»¶ä¸ä¼šå¹²æ‰°clickäº‹ä»¶
- ä½¿ç”¨äº‹ä»¶å§”æ‰˜æˆ–äº‹ä»¶ä¼˜å…ˆçº§å¤„ç†

#### 2.3 å·¥å…·æç¤ºæ˜¾ç¤ºé€»è¾‘
- åªåœ¨mouseoveræ—¶æ˜¾ç¤ºå·¥å…·æç¤º
- åœ¨clickæˆ–mouseoutæ—¶éšè—å·¥å…·æç¤º

### 3. å…·ä½“ä¿®æ”¹

#### 3.1 ä»»åŠ¡æ ‡é¢˜ç®€åŒ–
```typescript
// æ¸²æŸ“ä»»åŠ¡æ ‡é¢˜
const taskTitle = svg.append('text')
  .attr('class', 'gantt-task-title')
  .attr('x', 60)
  .attr('y', y + 12)
  .attr('font-size', '12px')
  .attr('fill', '#333333')
  .style('cursor', 'pointer')
  .text(`ğŸ” ${task.name}`);
// ç§»é™¤äº†mouseoverå’Œmouseoutäº‹ä»¶å¤„ç†å™¨
```

#### 3.2 ä»»åŠ¡æ¡äº‹ä»¶ä¼˜åŒ–
```typescript
// æ¸²æŸ“ä»»åŠ¡æ¡
const taskBar = svg.append('rect')
  .attr('class', 'gantt-task-bar')
  // ... å…¶ä»–å±æ€§
  .on('click', function(event) {
    // é˜»æ­¢äº‹ä»¶ä¼ æ’­ï¼Œé¿å…è§¦å‘å…¶ä»–äº‹ä»¶
    event.stopPropagation();
    onTaskClick?.(task);
  })
  .on('mouseover', function() {
    // æ˜¾ç¤ºå·¥å…·æç¤º
    d3.select(this)
      .attr('height', 22)
      .attr('y', y - 17);
    
    const fullStartDate = new Date(task.start).toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' });
    const fullEndDate = new Date(task.end).toLocaleDateString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit' });
    const startTypeText = task.startTimeType === 'actual' ? 'å®é™…' : 'è®¡åˆ’';
    const endTypeText = task.endTimeType === 'actual' ? 'å®é™…' : 'è®¡åˆ’';
    const statusText = getStatusText(task.custom_class);
    
    const tooltipContent = [
      `å¼€å§‹æ—¶é—´ (${startTypeText}): ${fullStartDate}`,
      `ç»“æŸæ—¶é—´ (${endTypeText}): ${fullEndDate}`,
      `çŠ¶æ€: ${statusText}`,
      `è¿›åº¦: ${task.progress}%`
    ];
    
    showTooltip(svg, tooltipContent, taskX + taskWidth / 2, y - 30, task.name, svgWidth);
  })
  .on('mouseout', function() {
    d3.select(this)
      .attr('height', 20)
      .attr('y', y - 16);
    
    svg.selectAll('.gantt-tooltip').remove();
  });
```

## å®ç°æ­¥éª¤

1. **ä¿®æ”¹renderTaskå‡½æ•°**
   - ç§»é™¤taskTitleçš„mouseoverå’Œmouseoutäº‹ä»¶
   - ä¼˜åŒ–taskBarçš„äº‹ä»¶å¤„ç†
   - æ·»åŠ äº‹ä»¶ä¼ æ’­æ§åˆ¶

2. **æµ‹è¯•éªŒè¯**
   - æµ‹è¯•ä»»åŠ¡ç‚¹å‡»åŠŸèƒ½
   - æµ‹è¯•é¼ æ ‡æ‚¬åœæ˜¾ç¤ºå·¥å…·æç¤º
   - ç¡®ä¿ä¸¤ä¸ªåŠŸèƒ½éƒ½èƒ½æ­£å¸¸å·¥ä½œ

## é¢„æœŸæ•ˆæœ

1. **ä»»åŠ¡ç‚¹å‡»æ­£å¸¸**ï¼šç‚¹å‡»ä»»åŠ¡æ¡æ—¶ï¼Œèƒ½æ­£å¸¸è§¦å‘onTaskClickå›è°ƒ
2. **å·¥å…·æç¤ºæ­£å¸¸**ï¼šé¼ æ ‡æ‚¬åœåœ¨ä»»åŠ¡æ¡ä¸Šæ—¶ï¼Œèƒ½æ­£å¸¸æ˜¾ç¤ºå·¥å…·æç¤º
3. **æ— å†²çª**ï¼šä¸¤ä¸ªåŠŸèƒ½äº’ä¸å¹²æ‰°ï¼Œç”¨æˆ·ä½“éªŒæµç•…

è¿™ä¸ªä¿®æ”¹å°†è§£å†³ä»»åŠ¡ç‚¹å‡»å’Œé¼ æ ‡æ‚¬åœçš„å†²çªé—®é¢˜ï¼Œç¡®ä¿ä¸¤ä¸ªåŠŸèƒ½éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚