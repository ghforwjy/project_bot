## 解决方案

### 问题1：按两次键盘才会退出语音模式

**方案A：修改判断逻辑**
- 在 `handleInputChange` 中，先检查是否正在录音
- 如果正在录音，直接停止录音，不依赖 `isVoiceResultRef` 标志位
- 移除或调整 `isVoiceResultRef` 的重置逻辑

**方案B：在 VoiceButton 中暴露录音开始回调**
- VoiceButton 暴露 `onRecordingStart` 回调
- 开始录音时通知 ChatPanel
- ChatPanel 在录音期间直接检测手工输入并停止

### 问题2：语音输入覆盖原有内容

**方案：在开始录音时保存输入框内容**
1. VoiceButton 暴露 `startRecording` 方法
2. ChatPanel 在调用 `startRecording` 前保存当前输入框内容
3. VoiceButton 在开始录音时触发回调，传递保存的内容
4. VoiceButton 在处理识别结果时，如果有保存的内容，则追加而不是覆盖

**推荐实现方式**：
- VoiceButton 添加 `onRecordingStart` 回调属性
- ChatPanel 在回调中保存当前输入框内容
- VoiceButton 在处理识别结果时，检查是否有保存的内容，有则追加

这样可以同时解决两个问题。