# 修复甘特图刷新问题的完整解决方案

## 问题根本原因

ProjectPanel 的 `refreshAllData` 函数没有失效甘特图查询缓存，导致点击刷新按钮时甘特图数据不会重新获取。

## 解决方案

修改 `frontend/src/components/project/ProjectPanel.tsx` 文件中的 `refreshAllData` 函数：

### 具体修改

在 `refreshAllData` 函数中添加甘特图查询的失效逻辑：

```typescript
const refreshAllData = () => {
  // 失效项目列表查询
  queryClient.invalidateQueries({ queryKey: ['projects'] })
  // 失效项目详情查询
  if (selectedProjectId) {
    queryClient.invalidateQueries({ queryKey: ['project', selectedProjectId] })
  }
  // 失效甘特图查询 - 这是新增的关键代码
  queryClient.invalidateQueries({ queryKey: ['gantt'] })
  // 刷新项目大类数据
  fetchCategories()
}
```

## 修改范围

- `frontend/src/components/project/ProjectPanel.tsx` - 修改 `refreshAllData` 函数

## 预期效果

修改后，点击页面上的刷新按钮将会：
1. 失效项目列表查询缓存
2. 失效项目详情查询缓存
3. **失效甘特图查询缓存（新增）**
4. 刷新项目大类数据

这样就能确保所有相关数据都会重新获取，包括甘特图中的任务状态。