# 为任务编辑框添加鼠标移动和拖动四边大小变化功能

## 分析现有实现

通过分析`ProjectDetailModal.tsx`文件，我发现项目明细框的移动和大小调整功能是通过以下方式实现的：

### 1. 状态管理
- `windowPosition`: 存储窗口位置
- `windowSize`: 存储窗口大小
- `isDragging`: 标记是否正在拖动
- `isResizing`: 标记是否正在调整大小
- `resizeDirection`: 存储调整大小的方向
- `dragStart`: 存储拖动开始时的状态
- `resizeStart`: 存储调整大小开始时的状态

### 2. 事件处理
- `handleHeaderMouseDown`: 处理标题栏鼠标按下事件，开始拖动
- `handleResizeMouseDown`: 处理调整大小鼠标按下事件，开始调整大小
- `handleMouseMove`: 处理鼠标移动事件，更新窗口位置或大小
- `handleMouseUp`: 处理鼠标释放事件，结束拖动或调整大小

### 3. 调整大小手柄
- 四个角的调整手柄（nw, ne, sw, se）
- 四个边的调整手柄（n, s, w, e）

## 实现计划

### 1. 修改TaskModal组件

#### 1.1 添加状态管理
- 添加窗口位置和大小状态
- 添加拖动和调整大小状态
- 添加鼠标事件处理状态

#### 1.2 实现事件处理函数
- 实现标题栏鼠标按下事件处理
- 实现调整大小鼠标按下事件处理
- 实现鼠标移动事件处理
- 实现鼠标释放事件处理

#### 1.3 添加调整大小手柄
- 添加四个角的调整手柄
- 添加四个边的调整手柄

#### 1.4 修改模态框结构
- 从使用Ant Design的Modal组件改为自定义模态框结构
- 添加标题栏和内容区域
- 添加调整大小手柄

### 2. 具体实现

#### 2.1 状态变量
```typescript
// 窗口位置和大小
const [windowPosition, setWindowPosition] = useState({ x: 200, y: 100 })
const [windowSize, setWindowSize] = useState({ width: 600, height: 700 })

// 拖动和调整大小状态
const [isDragging, setIsDragging] = useState(false)
const [isResizing, setIsResizing] = useState(false)
const [resizeDirection, setResizeDirection] = useState<string>('se')
const [dragStart, setDragStart] = useState({ x: 0, y: 0, mouseX: 0, mouseY: 0 })
const [resizeStart, setResizeStart] = useState({ x: 0, y: 0, width: 0, height: 0, mouseX: 0, mouseY: 0 })

// 引用
const windowRef = useRef<HTMLDivElement>(null)
const headerRef = useRef<HTMLDivElement>(null)
```

#### 2.2 事件处理函数
- 实现标题栏鼠标按下事件处理
- 实现调整大小鼠标按下事件处理
- 实现鼠标移动事件处理
- 实现鼠标释放事件处理
- 添加和移除鼠标事件监听器

#### 2.3 调整大小手柄
- 在模态框的四个角和四个边添加调整大小手柄
- 为每个手柄设置相应的鼠标按下事件处理函数

#### 2.4 模态框结构
- 使用自定义的div结构替代Ant Design的Modal组件
- 添加标题栏，实现拖动功能
- 添加内容区域，包含任务编辑表单
- 添加调整大小手柄，实现大小调整功能

### 3. 实现步骤

1. **修改TaskModal组件的结构**
   - 替换Ant Design的Modal组件为自定义模态框结构
   - 添加必要的状态变量

2. **实现拖动功能**
   - 添加标题栏鼠标按下事件处理
   - 实现鼠标移动和释放事件处理
   - 添加鼠标事件监听器

3. **实现调整大小功能**
   - 添加调整大小手柄
   - 实现调整大小鼠标按下事件处理
   - 实现鼠标移动和释放事件处理
   - 添加鼠标事件监听器

4. **测试验证**
   - 测试鼠标移动功能
   - 测试拖动四边大小变化功能
   - 确保任务编辑功能仍然正常工作

### 4. 注意事项

- 确保模态框的最小宽度和高度
- 确保鼠标事件处理不会干扰其他功能
- 确保拖动和调整大小功能在不同浏览器中正常工作
- 确保任务编辑表单的响应式布局

这个实现将使任务编辑框具有与项目明细框相同的交互体验，提高用户体验的一致性。