# 在任务编辑下拉选项中增加删除功能

## 一、功能需求

### 1.1 需求描述
- 在任务编辑的状态选择下拉框中添加"删除"选项
- 用户选择"删除"时，弹出确认对话框
- 用户确认后，调用后端API删除任务
- 删除成功后，关闭编辑状态并刷新项目数据

### 1.2 不涉及的内容
- 不修改后端删除API（已存在）
- 不修改其他组件
- 不修改项目详情页面的其他功能

## 二、技术实现方案

### 2.1 修改 ProjectDetailModal.tsx

**添加删除相关状态**
- 添加 `deleteConfirmVisible` 状态：控制删除确认对话框显示

**修改状态选择下拉框**
- 在状态选择的 Select.Option 中添加"删除"选项
- 值设为 `"delete"`（特殊值，用于识别删除操作）

**添加删除确认对话框**
- 使用 Ant Design 的 Modal 组件
- 标题："确认删除任务"
- 内容："确定要删除该任务吗？此操作不可恢复。"
- 确认按钮：调用删除API
- 取消按钮：关闭对话框

**实现删除逻辑**
- 添加 `handleDeleteTask` 函数：
  1. 调用后端API：`DELETE /api/v1/projects/{projectId}/tasks/{taskId}`
  2. 删除成功后：
     - 关闭编辑状态
     - 关闭删除确认对话框
     - 刷新项目数据
  3. 删除失败后：显示错误提示

**修改状态变更处理**
- 在状态选择的 onChange 事件中：
  - 如果选择的是 `"delete"`，打开删除确认对话框
  - 如果选择的是其他状态，正常更新编辑数据

### 2.2 后端API

**使用现有API**
- 已有删除任务API：`DELETE /projects/{project_id}/tasks/{task_id}`
- 无需修改后端代码

## 三、UI/UX 设计细节

### 3.1 状态选择下拉框
- 位置：任务表格的"状态"列
- 选项：
  - 待开始
  - 进行中
  - 已完成
  - 已延期
  - 已取消
  - **删除**（新增，红色文字，分隔线）

### 3.2 删除确认对话框
- 宽度：400px
- 标题颜色：`#ff4d4f`（红色）
- 确认按钮：红色背景 `#ff4d4f`，白色文字
- 取消按钮：默认样式
- 图标：使用 `ExclamationCircleOutlined` 图标

### 3.3 交互流程
1. 用户点击任务编辑按钮
2. 状态选择下拉框显示
3. 用户选择"删除"选项
4. 删除确认对话框弹出
5. 用户点击"确认"按钮
6. 调用删除API
7. 删除成功，关闭对话框和编辑状态
8. 任务列表刷新，任务被移除

## 四、实现步骤

1. **修改 ProjectDetailModal.tsx**
   - 添加 `deleteConfirmVisible` 状态
   - 在状态选择下拉框中添加"删除"选项
   - 添加删除确认对话框组件
   - 实现 `handleDeleteTask` 函数
   - 修改状态选择的 onChange 处理逻辑

2. **测试功能**
   - 测试选择"删除"选项是否弹出确认对话框
   - 测试确认删除是否成功删除任务
   - 测试取消删除是否正常关闭对话框

