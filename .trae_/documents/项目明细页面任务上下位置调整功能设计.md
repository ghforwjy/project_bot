# 项目明细页面任务上下位置调整功能设计

## 问题分析
项目明细页面需要支持任务上下位置调整，并且调整后甘特图上的任务顺序也要同步变化。目前任务数据没有明确的排序字段，需要设计一个解决方案来实现这个功能。

## 设计方案

### 1. 数据库设计
- 在 `tasks` 表中添加 `order` 字段（INTEGER类型），用于存储任务的排序顺序
- 默认值为0，新创建的任务会被添加到末尾

### 2. 后端实现
- **修改 `models/entities.py`**：在 `Task` 类中添加 `order` 字段
- **修改 `api/project.py`**：添加任务顺序调整的API接口
  - `POST /api/v1/projects/{project_id}/tasks/{task_id}/move` 接口
  - 支持 `direction` 参数（"up" 或 "down"）
- **修改 `api/gantt.py`**：修改甘特图数据的获取逻辑，按照 `order` 字段排序
- **修改 `core/project_service.py`**：添加 `move_task` 方法，处理任务顺序调整的业务逻辑

### 3. 前端实现
- **修改 `ProjectDetailModal.tsx`**：
  - 在任务列表中添加上下移动按钮
  - 使用 `UpOutlined` 和 `DownOutlined` 图标
  - 实现任务上下移动的点击事件处理
  - 调用后端API调整任务顺序
  - 调整后刷新任务列表
- **修改 `GanttChart.tsx`**：确保甘特图按照任务的 `order` 字段排序显示

### 4. UI/UX 设计
- **按钮位置**：在任务列表的每一行末尾添加上下移动按钮
- **按钮样式**：使用 Ant Design 的 `IconButton`，保持与现有UI风格一致
- **交互反馈**：
  - 点击按钮后显示加载状态
  - 调整成功后显示成功提示
  - 调整失败后显示错误提示
- **视觉提示**：按钮在鼠标悬停时高亮显示
- **边界处理**：
  - 第一个任务的上移按钮禁用
  - 最后一个任务的下移按钮禁用

### 5. 限制修改范围
- 只修改与任务顺序相关的代码
- 不影响其他功能和代码
- 保持现有的API接口和数据结构不变
- 只在必要的地方添加新的代码

## 实现步骤
1. **添加数据库字段**：在 `tasks` 表中添加 `order` 字段
2. **实现后端API**：添加任务顺序调整的API接口
3. **修改前端组件**：在项目明细页面添加任务上下移动按钮
4. **测试功能**：确保任务调整后甘特图顺序也同步变化
5. **优化用户体验**：添加适当的交互反馈

## 预期效果
- 用户可以在项目明细页面通过点击上下按钮调整任务顺序
- 调整后，甘特图上的任务顺序也会同步变化
- 操作简单直观，符合UI/UX原则
- 不影响其他功能的正常使用