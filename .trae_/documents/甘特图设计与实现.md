# 甘特图设计与实现计划

## 设计目标
- 体现不同项目大类、不同项目、不同阶段的情况
- 为每个项目提供详细说明
- 支持多级分组和层次结构
- 提供良好的用户交互体验

## 后端实现

### 1. 扩展API端点
- **修改现有端点**：`/api/v1/projects/{project_id}/gantt`
  - 增加项目描述信息返回
  - 优化数据结构

- **新增端点**：`/api/v1/gantt/all`
  - 返回所有项目的甘特图数据
  - 按项目大类分组
  - 包含项目描述和阶段信息

### 2. 数据结构设计
```typescript
interface GanttData {
  project_categories: ProjectCategoryGantt[]
}

interface ProjectCategoryGantt {
  id: number
  name: string
  projects: ProjectGantt[]
}

interface ProjectGantt {
  id: number
  name: string
  description: string
  start_date: string
  end_date: string
  progress: number
  tasks: GanttTask[]
  phases: ProjectPhase[]
}

interface ProjectPhase {
  id: string
  name: string
  start: string
  end: string
  description: string
}

interface GanttTask {
  id: string
  name: string
  start: string
  end: string
  progress: number
  assignee: string
  phase_id?: string
  custom_class: string
}
```

## 前端实现

### 1. 扩展甘特图组件
- **修改现有组件**：`GanttChart.tsx`
  - 支持显示项目描述
  - 支持按项目大类分组
  - 优化ECharts配置

- **新增功能**：
  - 项目大类切换器
  - 项目详情弹窗
  - 阶段显示功能

### 2. 界面设计
- **顶部控制栏**：
  - 项目大类选择器
  - 视图模式切换（按项目/按阶段）
  - 时间范围选择

- **甘特图主体**：
  - 左侧项目树（按大类分组）
  - 中间甘特图时间轴
  - 右侧项目详情面板

- **交互功能**：
  - 点击项目显示详情
  - 悬停显示项目描述
  - 支持项目和任务的展开/折叠

### 3. 可视化优化
- **颜色方案**：
  - 不同大类使用不同主色调
  - 同一大类下的项目使用渐变色调
  - 阶段使用不同的颜色标识

- **布局优化**：
  - 响应式设计
  - 支持横向滚动
  - 优化时间轴显示

## 实现步骤

### 1. 后端开发
- [x] 分析现有API实现
- [ ] 扩展数据模型
- [ ] 实现新的API端点
- [ ] 优化数据库查询

### 2. 前端开发
- [x] 分析现有甘特图组件
- [ ] 扩展组件功能
- [ ] 实现项目大类分组
- [ ] 添加项目描述显示
- [ ] 实现阶段可视化
- [ ] 优化用户交互

### 3. 测试与优化
- [ ] 测试不同规模的数据渲染
- [ ] 优化性能
- [ ] 调整UI细节
- [ ] 完善文档

## 技术要点
- 使用ECharts实现复杂甘特图
- 后端使用SQLAlchemy优化查询
- 前端使用React Query管理数据
- 实现多级数据分组和层次显示
- 提供丰富的交互功能和用户反馈

## 预期效果
- 清晰展示不同项目大类的分布
- 详细显示每个项目的计划和进度
- 直观展示项目的不同阶段
- 为用户提供完整的项目信息
- 支持快速导航和筛选